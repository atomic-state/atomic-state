/**  @license Atomic State
 * Copyright (c) Dany Beltran
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
(()=>{let{createContext:b,useCallback:m,useContext:n,useEffect:o,useMemo:p,useRef:q,useState:r}=React;class s{constructor(){this.suscribers={}}async addListener(a,b){a in this.suscribers||(this.suscribers[a]={});let c=Object.keys(this.suscribers[a]).length+1;"__proto__"!==a&&"prototype"!==a?this.suscribers[a][c]=b:console.warn('"prototype" and "__proto__" are not valid message names')}async removeListener(a,c){for(let b in this.suscribers[a])this.suscribers[a][b]===c&&delete this.suscribers[a][b]}emit(a,b){for(let c in this.suscribers[a])this.suscribers[a][c](b)}}function t(){let a=new s;return{observer:a,notify:function(b,c,d){a.emit(b,{storeName:b,hookCall:c,payload:d})}}}let u={},v={},w={},x={},y={},z={},A={},B={},C=b({prefix:"store"}),c=({children:g,atoms:d,filters:e,prefix:f="store"})=>{let h=n(C),a=void 0===f?h.prefix:f;if(d)for(let b in d)void 0===v[`${a}-${b}`]&&(v[`${a}-${b}`]=d[b],w[`${a}-${b}`]=!0);if(e)for(let c in e)void 0===z[`${a}-${c}`]&&(z[`${a}-${c}`]=e[c],x[`${a}-${c}`]=!0);return React.createElement(C.Provider,{value:{prefix:a}},g)},D={},E={};function F(a){let{effects:z=[],persist:i,localStoragePersistence:j,sync:F=!0,onSync:G=()=>{}}=a,{prefix:k}=n(C),b=k+"-"+a.name,[H,I]=r(!1),l=j||i,f=p(()=>`${Math.random()}`.split(".")[1],[]);b in A||(A[b]=[]);let J=void 0!==a.default,d=function(){let f=void 0===v[b]&&"function"==typeof a.default,d=f?a.default():a.default instanceof Promise?a.default:void 0,e=d instanceof Promise,c=J&& void 0===v[b]?e?a.default:void 0!==d?d:a.default:v[b];try{return l?"undefined"!=typeof localStorage&&(void 0===v[b]||w[b])&&(w[b]=!1,v[b]=e?void 0:c):void 0===v[b]&&(v[b]=c),c}catch(g){return c}}(),[s,K]=r(()=>{try{return(async()=>{let c="undefined"==typeof localStorage?a.default:await localStorage.getItem(b);return"undefined"==typeof localStorage?a.default:JSON.parse(c)||a.default})()}catch(c){return d}}),[c,L]=r((d instanceof Promise||"function"==typeof d)&& void 0===v[b]?void 0:(v[b]=d,d));B[b]||(B[b]=0),u[b]||(u[b]=t());let{observer:M,notify:x}=u[b],[g,N]=r(!1),h=q(!1),e=m(j=>{let k=!1,d,m;function n(){k=!0}d="function"==typeof j?j(c):j,m=(()=>{try{return JSON.stringify(d)!==JSON.stringify(v[b])}catch(a){return!1}})();let o=(()=>{try{if("function"==typeof v[b])return!0;if(JSON.stringify(d)===JSON.stringify(a.default)&&!D[b])return D[b]=!0,!0}catch(c){return!0}})(),p="function"==typeof v[b]||m||o;try{for(let q of A[b])q()}catch(s){}finally{A[b]=[];try{if(g||h.current)for(let r of z){let i=r({previous:c,state:d,dispatch:e,cancel:n});i instanceof Promise?i.then(a=>{void 0===a||a?"function"==typeof a&&A[b].push(a):k=!0}):void 0===i||i?"function"==typeof i&&A[b].push(i):k=!0}}catch(t){N(!0)}finally{if(!k){v[b]=d,l&&localStorage.setItem(b,JSON.stringify(d));try{p&&x(b,f,d)}finally{L(d)}}}}},[f,x,g,h,c,a.name]);o(()=>{async function a(){if("undefined"!=typeof localStorage&& void 0!==localStorage[b])try{if(localStorage[b]!==JSON.stringify(v[b])){let a=JSON.parse(localStorage[b]);e(a),await G(a)}}catch(c){}}if(l&&"undefined"!=typeof window){let c=void 0!==window.addEventListener;if(c&&F)return window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a)}}return()=>{}},[a.name]),o(()=>{async function a(){if(E[b]=!0,void 0!==s&&!h.current){let a=setTimeout(async()=>{if(l){let a=await s;JSON.stringify(a)===JSON.stringify(v[b])||D[b]||e(a),I(!0)}},0),c=setTimeout(()=>{K(void 0),h.current=!0},0);return()=>{clearTimeout(a),clearTimeout(c)}}}E[b]||a()},[s,e,h]),o(()=>{async function d(){var d;if(void 0===v[b]&&"function"==typeof a.default){if(0===B[b]){B[b]+=1;let g=void 0!==a.default?(async()=>"function"==typeof a.default?a.default():a.default)():void 0;void 0!==g&&g.then(a=>{v[b]=a,x(b,f,v[b]),e(a)})}else B[b]+=1,(c||v[b])&&(null===(d=u[b])|| void 0===d||d.notify(b,f,void 0!==c?c:v[b]))}}d()},[c,a.default,e,a.name,f]),o(()=>()=>{B[b]=0},[a.name]),o(()=>{let a=async a=>{a.hookCall!==f&&L(a.payload)};return M.addListener(b,a),()=>{M.removeListener(b,a)}},[g]),o(()=>{async function a(){if("undefined"!=typeof localStorage){let d="undefined"!=typeof window,e=d&&"addEventListener"in window;if(l&&(!e||H)){let f=await localStorage.getItem(b);f!==JSON.stringify(v[b])&&localStorage.setItem(b,JSON.stringify(c))}else{let a=await localStorage.getItem(b);void 0===a&&null!==a||l||localStorage.removeItem(b)}}}a()},[a.name,l,c]);let O=p(()=>a.actions||{},[]),y=p(()=>Object.fromEntries(Object.keys(O).map(a=>[a,b=>O[a]({args:b,state:c,dispatch:e}),])),[c]);return[c,e,y]}let G={};function a(a){a.ignoreKeyWarning&&(G[a.name]=!0),!G[a.name]&&a.name in y&&console.warn(`Duplicate atom name '${a.name}' found. This could lead to bugs in atom state. To remove this warning add 'ignoreKeyWarning: true' to all atom definitions that use the name '${a.name}'.`),y[a.name]=!0;let b=()=>F(a);return b["atom-name"]=a.name,b["init-object"]=a,b}let H=a,I={},J={},K={},L={};function d(b){let{name:c="",get:d}=b,e={},f={},a=()=>{let k={},l={};a.deps={};let{prefix:g}=n(C);e[`${g}-`]||(e[`${g}-`]={});let h=g+"-"+c;K[h]||(K[h]=t());let q=K[h],s=m(function(a,b){q.notify(h,a,b)},[g,h]),w=p(()=>({get:b=>("function"!=typeof b?(e[`${g}-`][`${g}-${b.name}`]=!0,k[`${g}-${b.name}`]=v[`${g}-${b.name}`],a.deps=Object.assign(Object.assign({},a.deps),{[`${g}-${b.name}`]:!0})):(e[`${g}-`][`${g}-${b["atom-name"]}`]=!0,k[`${g}-${b["atom-name"]}`]=v[`${g}-${b["atom-name"]}`],a.deps=Object.assign(Object.assign({},a.deps),{[`${g}-${b["atom-name"]}`]:!0})),"function"!=typeof b?void 0===v[`${g}-${b.name}`]?b.default:v[`${g}-${b.name}`]:void 0===v[`${g}-${b["atom-name"]}`]?b["init-object"].default:v[`${g}-${b["atom-name"]}`]),read(a){var b;return"function"!=typeof a?l[`${g}-${a.name}`]=!0:l[`${g}-${a["filter-name"]}`]=!0,"function"!=typeof a?void 0===z[`${g}-${a.name}`]?a.default:z[`${g}-${a.name}`]:void 0===z[`${g}-${a["filter-name"]}`]?null===(b=a["init-object"])|| void 0===b?void 0:b.default:z[`${g}-${a["filter-name"]}`]}}),[g]),y=p(()=>Math.random(),[]),i=function(){try{return J[h]?z[h]:(()=>{J[h]=!0,z[h]=b.default;let a;try{if(a=d(w),void 0===a)return b.default;(async()=>{z[h]=await a})()}catch(c){}finally{return a}})()}catch(a){return b.default}}(),[j,A]=r(i instanceof Promise|| void 0===i?b.default:(z[h]=i,i));async function B(a){if("function"==typeof a.payload||JSON.stringify(a.payload)!==JSON.stringify(k[a.storeName])){a.storeName in e[`${g}-`]&&(k[a.storeName]=a.payload);try{if(!f[h]){f[h]=!0;let b=setTimeout(async()=>{let c=a.storeName in e[`${g}-`]||a.storeName in l?await d(w):z[h];z[h]=c,s(y,c),A(c),f[h]=!1,clearTimeout(b)},0)}}catch(c){}}}async function D(a){let{storeName:c,payload:b}=a;y!==a.hookCall&&A(b)}return o(()=>{J[h]||s(y,j)},[j]),o(()=>{i instanceof Promise&&i.then(a=>{z[h]=a,A(a)})},[i]),o(()=>{var a,b;if(!L[h]){for(let c in L[h]=!0,x[h]&&d(w),e[`${g}-`])null===(a=u[c])|| void 0===a||a.observer.addListener(c,B);for(let f in l)null===(b=K[f])|| void 0===b||b.observer.addListener(f,B);return()=>{var a,b;for(let c in x[h]=!0,e[`${g}-`])null===(a=u[c])|| void 0===a||a.observer.removeListener(c,B);for(let d in l)null===(b=K[d])|| void 0===b||b.observer.removeListener(d,B)}}},[b,g]),o(()=>{var a;return null===(a=q.observer)|| void 0===a||a.addListener(h,D),()=>{var a;L[h]=!1,null===(a=null==q?void 0:q.observer)|| void 0===a||a.removeListener(h,D)}},[b,g]),j};return a["filter-name"]=c,a["init-object"]=b,a}function e(a){let{prefix:b}=n(C);return"function"!=typeof a?(void 0===I[`${b}-${a.name}`]?I[`${b}-${a.name}`]=d(a):I[`${b}-${a.name}`]["init-object"]!==a&&(I[`${b}-${a.name}`]=d(a)),I[`${b}-${a.name}`]()):a()}let M={};function f(a){return"function"!=typeof a&&(void 0===M[a.name]?M[a.name]=H(a):M[a.name]["init-object"]!==a&&(M[a.name]=H(a))),"function"!=typeof a?M[a.name]():a()}function g(a){return f(a)[0]}function h(a){return f(a)[1]}function i(a){return f(a)[2]}let N=(()=>{let a=new s;return a})();function j(a){let[b,c]=r(a||{});async function d(){let b={};if("undefined"!=typeof localStorage){for(let a in localStorage)if(!a.match(/clear|getItem|key|length|removeItem|setItem/))try{void 0!==localStorage[a]&&(b[a]=JSON.parse(localStorage[a]))}catch(d){b[a]=localStorage[a]}}c(b)}return o(()=>{d()},[]),o(()=>(N.addListener("store-changed",d),()=>{N.removeListener("store-changed",d)}),[]),b}let k={set(b,a){"undefined"!=typeof localStorage&&"function"==typeof localStorage.setItem&&(localStorage.setItem(b,JSON.stringify(a)),N.emit("store-changed",a))},async remove(a){"undefined"!=typeof localStorage&&"function"==typeof localStorage.removeItem&&(localStorage.removeItem(a),N.emit("store-changed",{}))},get(b,a=null){if("undefined"==typeof localStorage)return a;if("function"==typeof localStorage.getItem)try{return JSON.parse(localStorage.getItem(b))}catch(c){return a}else try{return JSON.parse(localStorage[b])}catch(d){return a}}};function l(c,a=null){let[b,d]=r(a),e=()=>{if("undefined"!=typeof localStorage&&JSON.stringify(localStorage[c])!==JSON.stringify(a))try{d(JSON.parse(localStorage[c]))}catch(b){d(a)}};return o(()=>(e(),N.addListener("store-changed",e),()=>{N.removeListener("store-changed",e)}),[]),b}window.atom=a,window.useAtom=f,window.useValue=g,window.useDispatch=h,window.useActions=i,window.AtomicState=c,window.filter=d,window.useFilter=e,window.storage=k,window.useStorage=j,window.useStorageItem=l})()