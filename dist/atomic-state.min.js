/**  @license Atomic State
 * Copyright (c) Dany Beltran
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
(()=>{let{createContext:b,useCallback:m,useContext:n,useEffect:o,useMemo:p,useRef:q,useState:r}=React;class s{constructor(){this.suscribers={}}async addListener(a,b){a in this.suscribers||(this.suscribers[a]={});let c=Object.keys(this.suscribers[a]).length+1;"__proto__"!==a&&"prototype"!==a?this.suscribers[a][c]=b:console.warn('"prototype" and "__proto__" are not valid message names')}async removeListener(a,c){for(let b in this.suscribers[a])this.suscribers[a][b]===c&&delete this.suscribers[a][b]}async emit(a,b){for(let c in this.suscribers[a])this.suscribers[a][c](b)}}function t(){let a=new s;return{observer:a,notify:function(b,c,d){a.emit(b,{storeName:b,hookCall:c,payload:d})}}}let u={},v={},w={},x={},y={},z={},A={},B={},C=b({prefix:"store"}),c=({children:g,atoms:d,filters:e,prefix:f="store"})=>{let h=n(C),a=void 0===f?h.prefix:f;if(d)for(let b in d)void 0===v[`${a}-${b}`]&&(v[`${a}-${b}`]=d[b],w[`${a}-${b}`]=!0);if(e)for(let c in e)void 0===z[`${a}-${c}`]&&(z[`${a}-${c}`]=e[c],x[`${a}-${c}`]=!0);return React.createElement(C.Provider,{value:{prefix:a}},g)},D={};function E(a){let{effects:z=[],persist:i,localStoragePersistence:j,sync:E=!0,onSync:F=()=>{}}=a,{prefix:k}=n(C),b=k+"-"+a.name,[G,H]=r(!1),l=j||i,f=p(()=>`${Math.random()}`.split(".")[1],[]);b in A||(A[b]=[]);let I=void 0!==a.default,d=function(){let f=void 0===v[b]&&"function"==typeof a.default,d=f?a.default():a.default instanceof Promise?a.default:void 0,e=d instanceof Promise,c=I&& void 0===v[b]?e?a.default:void 0!==d?d:a.default:v[b];try{return l?"undefined"!=typeof localStorage&&(void 0===v[b]||w[b])&&(w[b]=!1,v[b]=e?void 0:c):void 0===v[b]&&(v[b]=c),c}catch(g){return c}}(),[s,J]=r(()=>{try{return(async()=>{let c=await localStorage.getItem(b);return JSON.parse(c)||a.default})()}catch(c){return d}}),[c,K]=r((d instanceof Promise||"function"==typeof d)&& void 0===v[b]?void 0:(v[b]=d,d));B[b]||(B[b]=0),u[b]||(u[b]=t());let{observer:L,notify:x}=u[b],[g,M]=r(!1),h=q(!1),e=m(j=>{let k=!1,i,l;function m(){k=!0}i="function"==typeof j?j(c):j,l=(()=>{try{return JSON.stringify(i)!==JSON.stringify(v[b])}catch(a){return!1}})();let n=(()=>{try{if("function"==typeof v[b])return!0;if(JSON.stringify(i)===JSON.stringify(a.default)&&!D[b])return D[b]=!0,!0}catch(c){return!0}})(),o="function"==typeof v[b]||l||n;try{for(let p of A[b])p()}catch(r){}finally{A[b]=[];try{if(g||h.current)for(let q of z){let d=q({previous:c,state:i,dispatch:e,cancel:m});d instanceof Promise?d.then(a=>{void 0===a||a?"function"==typeof a&&A[b].push(a):k=!0}):void 0===d||d?"function"==typeof d&&A[b].push(d):k=!0}}catch(s){M(!0)}finally{k||(v[b]=i,o&&x(b,f,i),K(i))}}},[f,x,g,h,c,a.name]);o(()=>{async function a(){if("undefined"!=typeof localStorage&& void 0!==localStorage[b])try{if(localStorage[b]!==JSON.stringify(v[b])){let a=JSON.parse(localStorage[b]);e(a),await F(a)}}catch(c){}}if(l&&"undefined"!=typeof window){let c=void 0!==window.addEventListener;if(c&&E)return window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a)}}return()=>{}},[a.name]),o(()=>{async function a(){if(void 0!==s&&!h.current){let a=setTimeout(async()=>{if(l){let a=await s;JSON.stringify(a)===JSON.stringify(v[b])||D[b]||e(a),H(!0)}},0),c=setTimeout(()=>{J(void 0),h.current=!0},0);return()=>{clearTimeout(a),clearTimeout(c)}}}a()},[s,e,h]),o(()=>{async function d(){var d;if(void 0===v[b]&&"function"==typeof a.default){if(0===B[b]){B[b]+=1;let g=void 0!==a.default?(async()=>"function"==typeof a.default?a.default():a.default)():void 0;void 0!==g&&g.then(a=>{v[b]=a,x(b,f,v[b]),e(a)})}else B[b]+=1,(c||v[b])&&(null===(d=u[b])|| void 0===d||d.notify(b,f,void 0!==c?c:v[b]))}}d()},[c,a.default,e,a.name,f]),o(()=>()=>{B[b]=0},[a.name]),o(()=>{let a=async a=>{a.hookCall!==f&&K(a.payload)};return L.addListener(b,a),()=>{L.removeListener(b,a)}},[g]),o(()=>{async function a(){if("undefined"!=typeof localStorage){let d="undefined"!=typeof window,e=d&&"addEventListener"in window;if(l&&(!e||G)){let f=await localStorage.getItem(b);f!==JSON.stringify(v[b])&&localStorage.setItem(b,JSON.stringify(c))}else{let a=await localStorage.getItem(b);void 0===a&&null!==a||l||localStorage.removeItem(b)}}}a()},[a.name,l,c]);let N=p(()=>a.actions||{},[]),y=p(()=>Object.fromEntries(Object.keys(N).map(a=>[a,b=>N[a]({args:b,state:c,dispatch:e}),])),[c]);return[c,e,y]}let F={};function a(a){a.ignoreKeyWarning&&(F[a.name]=!0),!F[a.name]&&a.name in y&&console.warn(`Duplicate atom name '${a.name}' found. This could lead to bugs in atom state. To remove this warning add 'ignoreKeyWarning: true' to all atom definitions that use the name '${a.name}'.`),y[a.name]=!0;let b=()=>E(a);return b["atom-name"]=a.name,b["init-object"]=a,b}let G=a,H={},I={},J={},K={};function d(b){let{name:c="",get:d}=b,e={},a=()=>{let j={},k={};a.deps={};let{prefix:f}=n(C);e[`${f}-`]||(e[`${f}-`]={});let g=f+"-"+c;J[g]||(J[g]=t());let l=J[g],q=m(function(a,b){l.notify(g,a,b)},[f,g]),s=p(()=>({get:b=>("function"!=typeof b?(e[`${f}-`][`${f}-${b.name}`]=!0,j[`${f}-${b.name}`]=v[`${f}-${b.name}`],a.deps=Object.assign(Object.assign({},a.deps),{[`${f}-${b.name}`]:!0})):(e[`${f}-`][`${f}-${b["atom-name"]}`]=!0,j[`${f}-${b["atom-name"]}`]=v[`${f}-${b["atom-name"]}`],a.deps=Object.assign(Object.assign({},a.deps),{[`${f}-${b["atom-name"]}`]:!0})),"function"!=typeof b?void 0===v[`${f}-${b.name}`]?b.default:v[`${f}-${b.name}`]:void 0===v[`${f}-${b["atom-name"]}`]?b["init-object"].default:v[`${f}-${b["atom-name"]}`]),read(a){var b;return"function"!=typeof a?k[`${f}-${a.name}`]=!0:k[`${f}-${a["filter-name"]}`]=!0,"function"!=typeof a?void 0===z[`${f}-${a.name}`]?a.default:z[`${f}-${a.name}`]:void 0===z[`${f}-${a["filter-name"]}`]?null===(b=a["init-object"])|| void 0===b?void 0:b.default:z[`${f}-${a["filter-name"]}`]}}),[f]),w=p(()=>Math.random(),[]),h=function(){try{return I[g]?z[g]:(()=>{I[g]=!0,z[g]=b.default;let a;try{if(a=d(s),void 0===a)return b.default;(async()=>{z[g]=await a})()}catch(c){}finally{return a}})()}catch(a){return b.default}}(),[i,y]=r(h instanceof Promise|| void 0===h?b.default:(z[g]=h,h));async function A(a){if("function"==typeof a.payload||JSON.stringify(a.payload)!==JSON.stringify(j[a.storeName])){a.storeName in e[`${f}-`]&&(j[a.storeName]=a.payload);try{let b=setTimeout(async()=>{let c=a.storeName in e[`${f}-`]||!("addEventListener"in window)?await d(s):z[g];z[g]=c,q(w,c),y(c),clearTimeout(b)},0)}catch(c){}}}async function B(a){let{storeName:c,payload:b}=a;w!==a.hookCall&&y(b)}return o(()=>{I[g]||q(w,i)},[i]),o(()=>{h instanceof Promise&&h.then(a=>{z[g]=a,y(a)})},[h]),o(()=>{var a,b;if(!K[g]){for(let c in K[g]=!0,x[g]&&d(s),e[`${f}-`])null===(a=u[c])|| void 0===a||a.observer.addListener(c,A);for(let h in k)null===(b=J[h])|| void 0===b||b.observer.addListener(h,A);return()=>{var a,b;for(let c in x[g]=!0,e[`${f}-`])null===(a=u[c])|| void 0===a||a.observer.removeListener(c,A);for(let d in k)null===(b=J[d])|| void 0===b||b.observer.removeListener(d,A)}}},[b,f]),o(()=>{var a;return null===(a=l.observer)|| void 0===a||a.addListener(g,B),()=>{var a;K[g]=!1,null===(a=null==l?void 0:l.observer)|| void 0===a||a.removeListener(g,B)}},[b,f]),i};return a["filter-name"]=c,a["init-object"]=b,a}function e(a){let{prefix:b}=n(C);return"function"!=typeof a?(void 0===H[`${b}-${a.name}`]?H[`${b}-${a.name}`]=d(a):H[`${b}-${a.name}`]["init-object"]!==a&&(H[`${b}-${a.name}`]=d(a)),H[`${b}-${a.name}`]()):a()}let L={};function f(a){return"function"!=typeof a&&(void 0===L[a.name]?L[a.name]=G(a):L[a.name]["init-object"]!==a&&(L[a.name]=G(a))),"function"!=typeof a?L[a.name]():a()}function g(a){return f(a)[0]}function h(a){return f(a)[1]}function i(a){return f(a)[2]}let M=(()=>{let a=new s;return a})();function j(a){let[b,c]=r(a||{});async function d(){let b={};if("undefined"!=typeof localStorage){for(let a in localStorage)if(!a.match(/clear|getItem|key|length|removeItem|setItem/))try{void 0!==localStorage[a]&&(b[a]=JSON.parse(localStorage[a]))}catch(d){b[a]=localStorage[a]}}c(b)}return o(()=>{d()},[]),o(()=>(M.addListener("store-changed",d),()=>{M.removeListener("store-changed",d)}),[]),b}let k={set(b,a){"undefined"!=typeof localStorage&&"function"==typeof localStorage.setItem&&(localStorage.setItem(b,JSON.stringify(a)),M.emit("store-changed",a))},async remove(a){"undefined"!=typeof localStorage&&"function"==typeof localStorage.removeItem&&(localStorage.removeItem(a),M.emit("store-changed",{}))},get(b,a=null){if("undefined"==typeof localStorage)return a;if("function"==typeof localStorage.getItem)try{return JSON.parse(localStorage.getItem(b))}catch(c){return a}else try{return JSON.parse(localStorage[b])}catch(d){return a}}};function l(c,a=null){let[b,d]=r(a),e=()=>{if("undefined"!=typeof localStorage&&JSON.stringify(localStorage[c])!==JSON.stringify(a))try{d(JSON.parse(localStorage[c]))}catch(b){d(a)}};return o(()=>(e(),M.addListener("store-changed",e),()=>{M.removeListener("store-changed",e)}),[]),b}window.atom=a,window.useAtom=f,window.useValue=g,window.useDispatch=h,window.useActions=i,window.AtomicState=c,window.filter=d,window.useFilter=e,window.storage=k,window.useStorage=j,window.useStorageItem=l})()