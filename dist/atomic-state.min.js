/**  @license Atomic State
 * Copyright (c) Dany Beltran
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */ (()=>{let{createContext:e,useCallback:t,useContext:n,useEffect:i,useMemo:r,useRef:o,useState:a}=React;class f{constructor(){this.suscribers={}}async addListener(e,t){e in this.suscribers||(this.suscribers[e]={});let n=Object.keys(this.suscribers[e]).length+1;"__proto__"!==e&&"prototype"!==e?this.suscribers[e][n]=t:console.warn('"prototype" and "__proto__" are not valid message names')}async removeListener(e,t){for(let n in this.suscribers[e])this.suscribers[e][n]===t&&delete this.suscribers[e][n]}emit(e,t){for(let n in this.suscribers[e])this.suscribers[e][n](t)}}function s(){let e=new f;return{observer:e,notify:function t(n,i,r){e.emit(n,{storeName:n,hookCall:i,payload:r})}}}let u={},l={},d={},c={},m={},y={},v={},$={},p=e({prefix:"store"}),h=({children:e,atoms:t,filters:i,prefix:o="store"})=>{let a=n(p),f=void 0===o?a.prefix:o;if(t)for(let s in t)void 0===l[`${f}-${s}`]&&(l[`${f}-${s}`]=t[s],d[`${f}-${s}`]=!0);if(i)for(let u in i)void 0===y[`${f}-${u}`]&&(y[`${f}-${u}`]=i[u],c[`${f}-${u}`]=!0);let m=Object.values(atomsInitializeObjects),v=r(()=>m.map(e=>React.createElement(AtomInitialize,{key:e.name+o,atm:e})),[]);return React.createElement(p.Provider,{value:{prefix:f}},v,e)},g={},b={};function L(e){let{effects:f=[],persist:c,localStoragePersistence:m,sync:y=!0,onSync:h=()=>{}}=e,{prefix:L}=n(p),I=L+"-"+e.name,[_,w]=a(!1),j=m||c,k=r(()=>`${Math.random()}`.split(".")[1],[]);I in v||(v[I]=[]);let E=void 0!==e.default,N=function t(){let n=void 0===l[I]&&"function"==typeof e.default,i=n?e.default():e.default instanceof Promise?e.default:void 0,r=i instanceof Promise,o=E&&void 0===l[I]?r?e.default:void 0!==i?i:e.default:l[I];try{return j?"undefined"!=typeof localStorage&&(void 0===l[I]||d[I])&&(d[I]=!1,l[I]=r?void 0:o):void 0===l[I]&&(l[I]=o),o}catch(a){return o}}(),[x,A]=a(()=>{try{return(async()=>{let t="undefined"==typeof localStorage?e.default:await localStorage.getItem(I);return"undefined"==typeof localStorage?e.default:JSON.parse(t)||e.default})()}catch(t){return N}}),[S,C]=a((N instanceof Promise||"function"==typeof N)&&void 0===l[I]?void 0:(l[I]=N,N));$[I]||($[I]=0),u[I]||(u[I]=s());let{observer:D,notify:K}=u[I],[T,W]=a(!1),F=o(!1),P=t(t=>{let n=!1,i,r;function o(){n=!0}i="function"==typeof t?t(S):t,r=(()=>{try{return JSON.stringify(i)!==JSON.stringify(l[I])}catch(e){return!1}})();let a=(()=>{try{if("function"==typeof l[I])return!0;if(JSON.stringify(i)===JSON.stringify(e.default)&&!g[I])return g[I]=!0,!0}catch(t){return!0}})(),s="function"==typeof l[I]||r||a;try{for(let u of v[I])u()}catch(d){}finally{v[I]=[];try{for(let c of f){let m=c({previous:S,state:i,dispatch:P,cancel:o});m instanceof Promise?m.then(e=>{void 0===e||e?"function"==typeof e&&v[I].push(e):n=!0}):void 0===m||m?"function"==typeof m&&v[I].push(m):n=!0}}catch(y){W(!0)}finally{if(!n){l[I]=i,j&&localStorage.setItem(I,JSON.stringify(i));try{s&&K(I,k,i)}finally{C(i)}}}}},[k,K,T,F,S,e.name]);i(()=>{async function e(){if("undefined"!=typeof localStorage&&void 0!==localStorage[I])try{if(localStorage[I]!==JSON.stringify(l[I])){let e=JSON.parse(localStorage[I]);P(e),await h(e)}}catch(t){}}if(j&&"undefined"!=typeof window){let t=void 0!==window.addEventListener;if(t&&y)return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}return()=>{}},[e.name]),i(()=>{async function e(){if(b[I]=!0,void 0!==x&&!F.current){let e=setTimeout(async()=>{if(j){let e=await x;JSON.stringify(e)===JSON.stringify(l[I])||g[I]||P(e),w(!0)}},0),t=setTimeout(()=>{A(void 0),F.current=!0},0);return()=>{clearTimeout(e),clearTimeout(t)}}}b[I]||e()},[x,P,F]),i(()=>{async function t(){var t;if(void 0===l[I]&&"function"==typeof e.default){if(0===$[I]){$[I]+=1;let n=void 0!==e.default?(async()=>"function"==typeof e.default?e.default():e.default)():void 0;void 0!==n&&n.then(e=>{l[I]=e,K(I,k,l[I]),P(e)})}else $[I]+=1,(S||l[I])&&(null===(t=u[I])||void 0===t||t.notify(I,k,void 0!==S?S:l[I]))}}t()},[S,e.default,P,e.name,k]),i(()=>()=>{$[I]=0},[e.name]),i(()=>{let e=async e=>{e.hookCall!==k&&C(e.payload)};return D.addListener(I,e),()=>{D.removeListener(I,e)}},[T]),i(()=>{async function e(){if("undefined"!=typeof localStorage){let e=await localStorage.getItem(I);void 0===e&&null!==e||j||localStorage.removeItem(I)}}e()},[e.name,j,S]);let V=r(()=>e.actions||{},[]),q=r(()=>Object.fromEntries(Object.keys(V).map(e=>[e,t=>V[e]({args:t,state:S,dispatch:P}),])),[S]);return[S,P,q]}let I={};function _(e){e.ignoreKeyWarning&&(I[e.name]=!0),m[e.name]=!0;let t=()=>L(e);return t["atom-name"]=e.name,t["init-object"]=e,t}let w=_,j={},k={},E={},N={};function x(e){let{name:o="",get:f}=e,d={},m={},v=()=>{let $={},h={};v.deps={};let{prefix:g}=n(p);d[`${g}-`]||(d[`${g}-`]={});let b=g+"-"+o;E[b]||(E[b]=s());let L=E[b],I=t(function e(t,n){L.notify(b,t,n)},[g,b]),_=r(()=>({get:e=>("function"!=typeof e?(d[`${g}-`][`${g}-${e.name}`]=!0,$[`${g}-${e.name}`]=l[`${g}-${e.name}`],v.deps=Object.assign(Object.assign({},v.deps),{[`${g}-${e.name}`]:!0})):(d[`${g}-`][`${g}-${e["atom-name"]}`]=!0,$[`${g}-${e["atom-name"]}`]=l[`${g}-${e["atom-name"]}`],v.deps=Object.assign(Object.assign({},v.deps),{[`${g}-${e["atom-name"]}`]:!0})),"function"!=typeof e?void 0===l[`${g}-${e.name}`]?e.default:l[`${g}-${e.name}`]:void 0===l[`${g}-${e["atom-name"]}`]?e["init-object"].default:l[`${g}-${e["atom-name"]}`]),read(e){var t;return"function"!=typeof e?h[`${g}-${e.name}`]=!0:h[`${g}-${e["filter-name"]}`]=!0,"function"!=typeof e?void 0===y[`${g}-${e.name}`]?e.default:y[`${g}-${e.name}`]:void 0===y[`${g}-${e["filter-name"]}`]?null===(t=e["init-object"])||void 0===t?void 0:t.default:y[`${g}-${e["filter-name"]}`]}}),[g]),w=r(()=>Math.random(),[]),j=function t(){try{return k[b]?y[b]:(()=>{k[b]=!0,y[b]=e.default;let t;try{if(t=f(_),void 0===t)return e.default;(async()=>{y[b]=await t})()}catch(n){}finally{return t}})()}catch(n){return e.default}}(),[x,A]=a(()=>j instanceof Promise||void 0===j?e.default:(y[b]=j,j));async function S(e){if("function"==typeof e.payload||JSON.stringify(e.payload)!==JSON.stringify($[e.storeName])){e.storeName in d[`${g}-`]&&($[e.storeName]=e.payload);try{if(!m[b]){m[b]=!0;let t=setTimeout(async()=>{let n=e.storeName in d[`${g}-`]||e.storeName in h?await f(_):y[b];y[b]=n,I(w,n),"function"==typeof n?A(()=>n):A(n),m[b]=!1,clearTimeout(t)},0)}}catch(n){}}}async function C(e){let{storeName:t,payload:n}=e;w!==e.hookCall&&("function"==typeof n?A(()=>n):A(n))}return i(()=>{k[b]||I(w,x)},[x,b]),i(()=>{j instanceof Promise&&j.then(e=>{y[b]=e,A(e)})},[j]),i(()=>()=>{k[b]=!1},[]),i(()=>{var e,t;if(!N[b]){for(let n in N[b]=!0,k[b]||f(_),d[`${g}-`])null===(e=u[n])||void 0===e||e.observer.addListener(n,S);for(let i in h)null===(t=E[i])||void 0===t||t.observer.addListener(i,S);return()=>{var e,t;for(let n in c[b]=!0,d[`${g}-`])null===(e=u[n])||void 0===e||e.observer.removeListener(n,S);for(let i in h)null===(t=E[i])||void 0===t||t.observer.removeListener(i,S)}}},[e,g]),i(()=>{var e;return null===(e=L.observer)||void 0===e||e.addListener(b,C),()=>{var e;N[b]=!1,null===(e=null==L?void 0:L.observer)||void 0===e||e.removeListener(b,C)}},[e,g,x]),x};return v["filter-name"]=o,v["init-object"]=e,v}function A(e){let{prefix:t}=n(p);return"function"!=typeof e?(void 0===j[`${t}-${e.name}`]?j[`${t}-${e.name}`]=x(e):j[`${t}-${e.name}`]["init-object"]!==e&&(j[`${t}-${e.name}`]=x(e)),j[`${t}-${e.name}`]()):e()}let S={};function C(e){return"function"!=typeof e&&(void 0===S[e.name]?S[e.name]=w(e):S[e.name]["init-object"]!==e&&(S[e.name]=w(e))),"function"!=typeof e?S[e.name]():e()}function D(e){return C(e)[0]}function K(e){return C(e)[1]}function T(e){return C(e)[2]}let W=(()=>{let e=new f;return e})();function F(e){let[t,n]=a(e||{});async function r(){let e={};if("undefined"!=typeof localStorage){for(let t in localStorage)if(!t.match(/clear|getItem|key|length|removeItem|setItem/))try{void 0!==localStorage[t]&&(e[t]=JSON.parse(localStorage[t]))}catch(i){e[t]=localStorage[t]}}n(e)}return i(()=>{r()},[]),i(()=>(W.addListener("store-changed",r),()=>{W.removeListener("store-changed",r)}),[]),t}let P={set(e,t){"undefined"!=typeof localStorage&&"function"==typeof localStorage.setItem&&(localStorage.setItem(e,JSON.stringify(t)),W.emit("store-changed",t))},async remove(e){"undefined"!=typeof localStorage&&"function"==typeof localStorage.removeItem&&(localStorage.removeItem(e),W.emit("store-changed",{}))},get(e,t=null){if("undefined"==typeof localStorage)return t;if("function"==typeof localStorage.getItem)try{return JSON.parse(localStorage.getItem(e))}catch(n){return t}else try{return JSON.parse(localStorage[e])}catch(i){return t}}};function V(e,t=null){let[n,r]=a(t),o=()=>{if("undefined"!=typeof localStorage&&JSON.stringify(localStorage[e])!==JSON.stringify(t))try{r(JSON.parse(localStorage[e]))}catch(n){r(t)}};return i(()=>(o(),W.addListener("store-changed",o),()=>{W.removeListener("store-changed",o)}),[]),n}window.atom=_,window.useAtom=C,window.useValue=D,window.useDispatch=K,window.useActions=T,window.AtomicState=h,window.filter=x,window.useFilter=A,window.storage=P,window.useStorage=F,window.useStorageItem=V})();